



<!-- feed it through our cssmin filter to minify -->
<style>
  body{font-family:sans-serif;margin:20px;font-size:small;width:90%;margin-right:auto;margin-left:auto;padding-top:15px}#profile_pic{float:right;margin:0 0 1em 1em}h1{line-height:1em;font-size:x-large;margin-bottom:.31em}h2{font-size:large;margin-bottom:1px}h3{font-size:small;margin-bottom:1px}a{text-decoration:none}a:hover{text-decoration:underline}a:visited{color:#00f}*,:after,:before{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.posts-area{width:100%;padding-top:10px}.posts-area:after{content:"";display:table;clear:both}.post{float:left;width:33.33%;padding-right:20px}.post .post-contents{background:#f7f7f7;border-radius:5px}.post .image a{display:block;overflow:hidden;height:214px}.post img{object-fit:cover;width:100%;height:100%}.post .text{height:200px;padding:20px}@media (max-width:680px){.post{width:100%}}body{font:13px/1.5 Verdana,Helvetica,Arial,sans-serif;width:80%}.img-with-caption{font-size:14px;text-align:center;margin:20 0;background-color:F1F1F1;padding:10px}#pullout{text-align:center}#intro{max-width:700px;display:inline-block;text-align:left}#post-content{max-width:800px}#profile_pic{float:right;margin:0 0 1em 1em}h1{line-height:1em;font-size:x-large;margin-bottom:.31em}h2{margin-bottom:1px;background-color:#eee;border:1px solid #999;display:block;padding:10px;width:max-content;font-size:20px;margin-right:40px;margin-bottom:5px}h3{font-size:14px;margin-bottom:1px;background-color:#eef;border:1px solid #999;display:block;padding:10px;width:max-content;margin-right:40px;margin-bottom:5px;text-align:left}ol,ul{max-width:650px}a{text-decoration:none}a:hover{text-decoration:underline}a:visited{color:#00f}*,:after,:before{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.posts-area{width:100%;padding-top:10px}.posts-area:after{content:"";display:table;clear:both}.post{float:left;width:33.33%;padding:0 20px 20px 0}.contribute{width:100%;padding-top:10px}.boxsmaller{background-color:#eee;border:1px solid #999;display:block;padding:10px;width:max-content;font-size:16px;margin-left:10px;margin-right:40px;margin-bottom:5px;text-align:center}.post .post-contents{border-radius:10px;padding:20px 20px 10px 20px}.post .project-contents{background:#eee;border-radius:10px;padding:20px 20px 10px 20px}.post .podcast-contents{background:#e9967a;border-radius:10px;padding:20px 20px 10px 20px}.post .note-contents{background:#e6e6fa;border-radius:10px;padding:20px 20px 10px 20px}.post .pedagogy-contents{background:#90ee90;border-radius:10px;padding:20px 20px 10px 20px}.post .talk-contents{background:pink;border-radius:10px;padding:20px 20px 10px 20px}.post .inter-contents{background:#add8e6;border-radius:5px}.post .image a{display:block;overflow:hidden;height:214px}.post img{object-fit:cover;width:100%;height:100%}img{max-height:500px;max-width:100%}table{margin:30 auto 30 auto;padding:10px;width:80%;text-align:left;border:1px solid #000}td{padding:10px;text-align:left;font-size:12}.post .text{min-height:250px;padding:5px}.post .inter-text{height:250px}audio{width:100%;height:30px}@media (max-width:1100px){.post{width:100%}table{width:100%}}code[class*=language-],pre[class*=language-]{color:#000;background:0 0;text-shadow:0 1px #fff;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}
</style>

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" type="image/x-icon" href="/img/edge_favicon.png" />
    <title>PVOS</title>
  </head>
  <body>
    <a href="/"><img src="/img/pvos.png" align:left></a>
    <div id='post-content'>

        <h1></h1>

  
  <h1>&quot;Rev F&quot; of the PVOS CO2 Monitoring Kit</h1>
<p>This is the home page for documentation, tutorials, and sample data for <a href="/co2/f">&quot;Revision F&quot; (&quot;REV_F&quot;)</a> of the <a href="/posts/co2">PVOS CO2 Monitoring Kit</a>.</p>
<p>The primary repository for hardware and firmware designs is on github <a href="https://github.com/p-v-o-s/co2-monitor/tree/main/rev_f">here</a>. Below you'll find a tutorial that includes an overview of the monitoring hardware; a guide to setting up the firmware; and a guide to getting data online.</p>
<table>
<thead>
<tr>
<th style="text-align:center"><img src="/img/rev_f_boards_sm.png" alt=""></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Rev F</strong> of the PVOS CO2 Monitor.</td>
</tr>
</tbody>
</table>
<h2>Table of Contents</h2>
<h3><a href="#hardware">Hardware Overview</a></h3>
<h3><a href="#firmware">Firmware Setup</a></h3>
<h3><a href="#wifi">Connecting Rev_F to your WiFi</a></h3>
<h3><a href="#online">Archiving CO2 Data Online</a></h3>
<h2><a name="hardware"></a> Hardware Setup</h2>
<p>Hardware design files are &quot;Free and Open Source&quot;, available on <a href="https://github.com/p-v-o-s/co2-monitor/blob/main/rev_f/hardware">github</a>.</p>
<h3>Ordering PCBs and parts for DIY</h3>
<p>You can order a PCB by submitting the <a href="">KiCad board file</a> to <a href="">OSHPARK</a> (link to file already shared on OSHPark <a href="">here</a>), the <a href="">gerbers</a> to JLCPB (quick link to order already set up [here]) -- this usually takes about a week or two, depending on shipping method.  You can also order them from <a href="">from PVOS.org</a> -- we have batches already manufactured, and we can typically ship them within a day or two.</p>
<table>
<thead>
<tr>
<th style="text-align:center"><img src="/img/co2/rev_f_schematic.png" alt=""></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Rev F</strong> PVOS CO2 Monitor schematic (generated in KiCAD). PDF version is <a href="https://github.com/p-v-o-s/co2-monitor/blob/main/rev_f/hardware/schematic.pdf">here</a>.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><img src="/img/co2/rev_f_board.png" alt=""></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Rev F</strong> PVOS CO2 Monitor board layout (generated in KiCAD).</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><img src="/img/co2/rev_f_render_jlcpcb.png" alt=""></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Rev F</strong> PVOS CO2 Monitor rendered by JLCPB.  You can order 5 boards for them via <a href="">this link</a>.</td>
</tr>
</tbody>
</table>
<h2><a name="firmware"></a>Firmware Setup</h2>
<p>Video tutorial covering how to set up the firmware is here:</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/7GUvPnLI-jg" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>You can also use the below guide:</p>
<h3>Arduino IDE Version</h3>
<p>The following firmware is based on version 1.8.13 or greater of the Arduino IDE. Earlier versions may work, but are currently untested.  Download the latest version <a href="https://www.arduino.cc/en/software">here</a>.</p>
<h3>Get the latest firmware for REV_F</h3>
<p>The current firmware (v0.1-alpha) can be downloaded <a href="https://gitlab.com/p-v-o-s/co2/co2monitor-firmware/-/raw/master/releases/v0.1-alpha.zip">here</a> as a zip file.  Extract the contents, and copy the entire folder named 'pvos_co2' (containing a file 'pvos_co2.ino', and a folder called 'data') into your Arduino Sketch folder.</p>
<h3>Adding support for the Heltec ESP32 Wifi Lora v2</h3>
<p>First, you should add support in the Arduino IDE for the Heltec.</p>
<p>There are very clear instructions <a href="https://randomnerdtutorials.com/installing-the-esp32-board-in-arduino-ide-windows-instructions/">here</a>.</p>
<p>Quick notes as reference:</p>
<p>You'll be adding the following JSON to the “Additional Board Manager URLs” field in <strong>File &gt; Preferences</strong>:</p>
<pre><code>    https://dl.espressif.com/dl/package_esp32_index.json
</code></pre>
<p>Then, under <strong>Tools &gt; Board &gt; Boards Manager</strong>, search for ESP32 and press install button for the “ESP32 by Espressif Systems“.</p>
<p>Finally, you can select the board under the <strong>Tools &gt; Board</strong> menu as:</p>
<pre><code>    Heltec Wifi Lora 32(V2)
</code></pre>
<h3>Installing Required Arduino libraries</h3>
<p>These can be installed via the Arduino IDE Library Manager:</p>
<ul>
<li>when you pull up &quot;co2monitor.ino&quot; in the Arduino IDE, you can click on each of the links in the comments above, and each will provide you with a button for installing the associated library.  You will need to click on each link sequentially, and install each (doesn't take long!):</li>
</ul>
<p><img src="/img/co2/library_manager_rev_f.png" alt=""></p>
<p>Alternatively, if you'd like to download the libraries manually via github and place them in the &quot;libraries&quot; folder of your Arduino sketch folder, you can do so via these links (to github repos for the libraries):</p>
<ul>
<li><a href="https://github.com/Hieromon/AutoConnect">Autoconnect</a></li>
<li><a href="https://github.com/sparkfun/SparkFun_SCD30_Arduino_Library">Sparkfun SCD30 library</a></li>
<li><a href="https://github.com/MartinL1/BMP388_DEV">BMP388_DEV</a></li>
<li><a href="https://github.com/thomasfredericks/Bounce2">Bounce2</a></li>
<li><a href="https://github.com/olikraus/u8g2">U8g2</a></li>
</ul>
<h3>Uploading the 'data' folder contents</h3>
<p>Install the ESP32 Filesystem Uploader following the instructions <a href="https://randomnerdtutorials.com/install-esp32-filesystem-uploader-arduino-ide/">here</a>.</p>
<p>Follow the same instructions to upload the 'data' folder to your Heltec via the ESP32. Note: before uploading, you must select the Heltec ESP32 Wifi LoRa (v2) board from the <strong>Tools &gt; Boards</strong> menu, and the proper Port from the <strong>Tools &gt; Port</strong> menu.</p>
<h2><a name="wifi"></a> Connecting Rev_F to WiFi</h2>
<p>After uploading the firmware as above, you can follow the instructions in the below video to connect your monitor to your WiFi locally:</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/mWnoT4Bof1I" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<h2><a name="online"></a> Collecting data online</h2>
<p>The following steps are for collecting data via <a href="">Bayou-CO2</a>.  Guides for getting data to Adafruit.io, Thingspeak, and other platforms forthcoming!</p>
<p>Video tutorial for this section is here:</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Qi7CdAqu774" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>Or follow the instructions below.</p>
<h3>1. Set up a Bayou-CO2 feed</h3>
<p>Follow the instructions on <a href="http://data.pvos.org/co2/">Bayou-CO2</a> for setting up a new feed.</p>
<p>(Coming soon: video tutorial)</p>
<h3>2. Connect to your hardware via wifi on your phone</h3>
<p>First, connect to the hotspot shown on the screen.</p>
<p>Configure the device on your local wifi, using your phone.</p>
<h3>3. Enter in your Bayou-CO2 credentials</h3>
<p>This is ideally done using a laptop (for easy copy-paste of credentials):</p>
<p>Press the side button to see the IP address to which your device is connected.</p>
<p>Navigate to this address on your laptop.</p>
<p>Enter in the public key and private key for your Bayou-CO2 feed.</p>
<h3>4. Check for new data online</h3>
<p>Navigate to http://data.pvos.org/co2/data/[ your public key] to see if data is flowing!</p>


    </div>
  </body>
</html>
